<div class="container">
  <h1>{{ isEdit ? 'Edit Product' : 'New Product' }}</h1>
  <p><a routerLink="/products" class="btn btn-secondary">Back to list</a></p>
  @if (error) {
    <p class="error">{{ error }}</p>
  }
  <form [formGroup]="form" (ngSubmit)="submit()">
    <div class="form-group">
      <label for="name">Name</label>
      <input id="name" type="text" formControlName="name" />
      @if (form.get('name')?.invalid && form.get('name')?.touched) {
        <span class="field-error">Name is required.</span>
      }
    </div>
    <div class="form-group">
      <label for="description">Description</label>
      <textarea id="description" formControlName="description" rows="3"></textarea>
    </div>
    <div class="form-group">
      <label for="categoryId">Category</label>
      <select id="categoryId" formControlName="categoryId">
        <option value="">-- Select category --</option>
        @for (c of categories; track c.id) {
          <option [value]="c.id">{{ c.name }}</option>
        }
      </select>
      @if (form.get('categoryId')?.invalid && form.get('categoryId')?.touched) {
        <span class="field-error">Category is required.</span>
      }
    </div>
    <div class="form-group">
      <label for="price">Price</label>
      <input id="price" type="number" step="0.01" formControlName="price" />
      @if (form.get('price')?.invalid && form.get('price')?.touched) {
        <span class="field-error">Valid price required.</span>
      }
    </div>
    <div class="form-group">
      <label for="stockQuantity">Stock quantity</label>
      <input id="stockQuantity" type="number" formControlName="stockQuantity" />
      @if (form.get('stockQuantity')?.invalid && form.get('stockQuantity')?.touched) {
        <span class="field-error">Valid quantity required.</span>
      }
    </div>
    <button type="submit" class="btn btn-primary" [disabled]="form.invalid || loading">
      {{ loading ? 'Saving...' : (isEdit ? 'Update' : 'Create') }}
    </button>
  </form>
</div>
